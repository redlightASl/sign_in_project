# 基于人脸识别的课程自动签到系统

## APP

`扫脸登录`

//用同一个算法

1. 教师

查看课程表、查询历史记录

查看当前课程学生签到情况

查看当前课程每个学生签到率

2. 学生

查看自己签到记录

查看当前课程签到/离退/暂离情况

## 服务器后端

账号密码登录

上传课程表、上传学生数据

## 服务器前端

学校教务系统接口

`上传excel，服务器处理`

## 流程 

1. 教务**网页端**上传课程表、学生和教师信息
2. 后端处理excel存储到数据库**课程表**和**时间表**
3. 上课学生签到
4. 人脸识别当前学生
5. 将识别结果【人脸指纹】发送到服务器（json）
6. 服务器将识别结果和**学生信息表**对比，计算签到率等
7. 将结果直接存到**签到信息表**
8. 将结果发送给学生端【学生信息表的对应行】和教师端【未签到学生、签到率】
9. 学生中途暂离，再次识别到学生
10. 将识别结果发送到服务器
11. 服务器进行对比，判断学生暂离
12. 将结果直接存到数据库
13. 将结果发送给学生端和教师端
14. 学生返回同9-13步
15. 到下课时间后，学生可以离退
16. 自动清除3个月之前的数据

## 数据库

### 学生信息表

学号 姓名 班级 照片【比较好的方法是这样的，存到文件，路径放到数据库生成索引，然后显示的页面缓存成静态的，然后将缓存和图片的印象都放到内存里，再写个算法动态清理不常访问的图片印象】人脸指纹

### 课程表

以课程代号为索引 存教师

### 时间表

以时间为索引

每条存储 终端编号 课程代号 学号

### 签到信息表

每条存扫脸时间 签到的终端编号 学号 课程代号 是签到/离退/暂离

## 硬件部分

### 运算部分：stm32h750

1. CPU+FPU+DSP

通过DCMI-DMA获取摄像头数据并进行解码

对当前数据进行人脸识别运算得到对应的人脸指纹

将人脸指纹通过DMA发送到控制部分

收取控制部分发来的指令数据并执行

2. DMA

搬运摄像头数据到内存

搬运内存学生信息至SPI接口缓存

### 控制部分：esp32

1. CPU

获取运算部分送来的人脸指纹数据

将数据打包（人脸指纹+本设备位置+时间戳）`加密`发送给WiFi模块

收取服务器的指令并发送给运算部分

控制运算部分及本设备进入低功耗休眠状态，直到服务器发来信息再进行唤醒

2. WiFi连接

连接局域网

通过HTTP套接字将数据发送到局域网服务器

接收来自服务器的指令并发送给CPU（如低功耗待机、唤醒、OTA升级等）

### 摄像头：OV5640（需求：自动调焦、高分辨率、镜头范围较广）

上电后运算部分自动控制摄像头进行人脸识别，如果识别到目标则自动发送给控制部分

控制部分会在低功耗模式下将摄像头断电

### 硬件算法

面部识别算法优化

网络数据发送算法优化

## 软件部分

学生端、教师端 安卓开发/网页开发

学生信息 数据库

服务器搭建

人脸识别算法

## 待定问题

【软件】发送信息加密、用什么算法加密

`直接使用esp32的硬件加密算法加速器`

【硬件】人脸识别短时间只识别一次如何实现

`上课后20min内的多次识别不计入数据`

【软件】【硬件】怎么把算法优化到最快

【软件】【硬件】怎么保证识别率

【软件】老师推迟/提前上下课、改课
